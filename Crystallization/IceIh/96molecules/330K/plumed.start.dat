# vim:ft=plumed

vol: VOLUME

REFCV ...
 SPECIES=1-288:3
 SIGMA=0.052
 CRYSTAL_STRUCTURE=CUSTOM
 LABEL=refcv
VECTOR1_1=-0.44855001000000017,0.0,0.0
VECTOR1_2=-0.2239375000000001,0.38903840000000006,0.0
VECTOR1_3=-0.2239375000000001,-0.3890399600000001,0.0
VECTOR1_4=-0.2239375000000001,-0.12962968,-0.36679181
VECTOR1_5=-0.2239375000000001,-0.12962968,0.3667890600000001
VECTOR1_6=-0.2239375000000001,-0.12962968,-0.09169613999999995
VECTOR1_7=0.0,0.25941341,0.3667890600000001
VECTOR1_8=0.0,0.25941341,-0.36679181
VECTOR1_9=0.0,0.25941341,-0.09169613999999995
VECTOR1_10=0.0,0.0,-0.45848800999999995
VECTOR1_11=0.0,0.0,0.2750928900000001
VECTOR1_12=0.22461250000000002,0.38903840000000006,0.0
VECTOR1_13=0.22461250000000002,-0.12962968,0.3667890600000001
VECTOR1_14=0.22461250000000002,-0.12962968,-0.09169613999999995
VECTOR1_15=0.22461250000000002,-0.12962968,-0.36679181
VECTOR1_16=0.22461250000000002,-0.3890399600000001,0.0
VECTOR1_17=0.44922500000000004,0.0,0.0
VECTOR2_1=-0.44855001000000017,0.0,0.0
VECTOR2_2=-0.2239375000000001,0.12962499000000002,0.36679346
VECTOR2_3=-0.2239375000000001,0.12962499000000002,-0.3667890600000001
VECTOR2_4=-0.2239375000000001,0.12962499000000002,-0.09169617
VECTOR2_5=-0.2239375000000001,0.38903852,0.0
VECTOR2_6=-0.2239375000000001,-0.38904309000000004,0.0
VECTOR2_7=0.0,0.0,-0.4584852
VECTOR2_8=0.0,0.0,0.27509285999999994
VECTOR2_9=0.0,-0.25941341,0.36679346
VECTOR2_10=0.0,-0.25941341,-0.3667890600000001
VECTOR2_11=0.0,-0.25941341,-0.09169617
VECTOR2_12=0.22461250000000002,0.38903852,0.0
VECTOR2_13=0.22461250000000002,0.12962499000000002,-0.09169617
VECTOR2_14=0.22461250000000002,0.12962499000000002,-0.3667890600000001
VECTOR2_15=0.22461250000000002,0.12962499000000002,0.36679346
VECTOR2_16=0.22461250000000002,-0.38904309000000004,0.0
VECTOR2_17=0.44922500000000004,0.0,0.0
VECTOR3_1=-0.4485500000000001,0.0,0.0
VECTOR3_2=-0.22461250000000002,-0.38903998,0.0
VECTOR3_3=-0.22461250000000002,0.12962968,0.36678903000000007
VECTOR3_4=-0.22461250000000002,0.38904309000000004,0.0
VECTOR3_5=-0.22461250000000002,0.12962968,-0.36679187
VECTOR3_6=-0.22461250000000002,0.12962968,0.09169613999999995
VECTOR3_7=0.0,-0.2594102800000001,-0.36679187
VECTOR3_8=0.0,-0.2594102800000001,0.36678903000000007
VECTOR3_9=0.0,-0.2594102800000001,0.09169613999999995
VECTOR3_10=0.0,0.0,0.4584852
VECTOR3_11=0.0,0.0,-0.27509567
VECTOR3_12=0.22461250000000002,0.12962968,-0.36679187
VECTOR3_13=0.22461250000000002,-0.38903998,0.0
VECTOR3_14=0.22461250000000002,0.12962968,0.36678903000000007
VECTOR3_15=0.22461250000000002,0.12962968,0.09169613999999995
VECTOR3_16=0.22461250000000002,0.38904309000000004,0.0
VECTOR3_17=0.44922502000000003,0.0,0.0
VECTOR4_1=-0.4485500000000001,0.0,0.0
VECTOR4_2=-0.22461250000000002,-0.38903840000000006,0.0
VECTOR4_3=-0.22461250000000002,-0.12962499000000002,0.09169617
VECTOR4_4=-0.22461250000000002,-0.12962499000000002,0.3667890299999999
VECTOR4_5=-0.22461250000000002,0.3890431399999999,0.0
VECTOR4_6=-0.22461250000000002,-0.12962499000000002,-0.36678903000000007
VECTOR4_7=0.0,0.0,0.45848963
VECTOR4_8=0.0,0.0,-0.2750928900000001
VECTOR4_9=0.0,0.25941352999999995,0.09169617
VECTOR4_10=0.0,0.25941352999999995,-0.36678903000000007
VECTOR4_11=0.0,0.25941352999999995,0.3667890299999999
VECTOR4_12=0.22461250000000002,-0.12962499000000002,0.3667890299999999
VECTOR4_13=0.22461250000000002,-0.12962499000000002,0.09169617
VECTOR4_14=0.22461250000000002,0.3890431399999999,0.0
VECTOR4_15=0.22461250000000002,-0.38903840000000006,0.0
VECTOR4_16=0.22461250000000002,-0.12962499000000002,-0.36678903000000007
VECTOR4_17=0.44922502000000003,0.0,0.0
 MORE_THAN={RATIONAL R_0=0.5 NN=10 MM=20}
 MEAN
... REFCV

# Construct a bias potential using VES
#
# Basis functions

bf1: BF_LEGENDRE ORDER=20 MINIMUM=0.0 MAXIMUM=96.0

# Target distribution

td_uni: TD_UNIFORM

# Expansion

VES_LINEAR_EXPANSION ...
 ARG=refcv.morethan
 BASIS_FUNCTIONS=bf1
 TEMP=330.0
 GRID_BINS=300
 TARGET_DISTRIBUTION=td_uni
 LABEL=b1
... VES_LINEAR_EXPANSION

# Optimization algorithm

OPT_AVERAGED_SGD ...
  BIAS=b1
  STRIDE=500
  LABEL=o1
  STEPSIZE=5.
  FES_OUTPUT=500
  BIAS_OUTPUT=500
  COEFFS_OUTPUT=100
  MULTIPLE_WALKERS
... OPT_AVERAGED_SGD

#OPT_DUMMY ...
#  BIAS=b1
#  STRIDE=500
#  LABEL=o1
#  MULTIPLE_WALKERS
#  COEFFS_OUTPUT=100
#... OPT_DUMMY

energy: ENERGY

REFCV ...
 SPECIES=1-288:3
 SIGMA=0.052
 CRYSTAL_STRUCTURE=CUSTOM
 LABEL=refcv3
VECTOR1_1=-0.45855485547911884,-4.3071945781036904e-05,0.0018901484946130865
VECTOR1_2=-0.23073903523735595,-0.13157259708801874,-0.37379710982463127
VECTOR1_3=-0.22968751030287857,-0.13226134495009206,-0.0929767403325048
VECTOR1_4=-0.22931472913879747,-0.3971847617922919,-3.552713678800501e-16
VECTOR1_5=-0.22924035743944238,0.3970601736135564,0.0018322256980788155
VECTOR1_6=-0.2278160513408828,0.13144800890928324,0.37562933552271005
VECTOR1_7=-0.0014947856775577861,0.2655712064500868,-0.37373918702809733
VECTOR1_8=-0.00037278116408145934,0.2649234168421991,-0.0929767403325048
VECTOR1_9=0.001122465582470511,-0.0007297054642876333,0.28087772713576203
VECTOR1_10=0.0014952467465519704,-0.26565312230648747,0.37385446746826645
VECTOR1_11=0.22774534066276397,-0.1315704833964226,-0.37562933552271077
VECTOR1_12=0.2289382858242334,-0.13225923060652392,-0.09480953118348268
VECTOR1_13=0.22924401846067896,0.3970622873051539,-3.552713678800501e-16
VECTOR1_14=0.22931106698831416,-0.3971826474487237,-0.0018327908509780501
VECTOR1_15=0.23080974478622807,0.13145012325285066,0.3737965446717322
VECTOR1_16=0.45855531654811305,-3.884391061959036e-05,-0.0017748680544439567
VECTOR2_1=-0.4585553165481123,3.884391061887982e-05,0.0017748680544436013
VECTOR2_2=-0.23080997588534907,-0.13153163948580443,-0.37385446746826684
VECTOR2_3=-0.22931129808743408,0.39710113121576995,0.0017748680544436013
VECTOR2_4=-0.22924424955979925,-0.39714380353810697,-5.7922796534271015e-05
VECTOR2_5=-0.22893851692335332,0.13217771437357087,0.09475160838694806
VECTOR2_6=-0.2277455717618846,0.13148896716346956,0.37557141272617617
VECTOR2_7=-0.0014952467465519704,0.26565312230648674,-0.37385446746826684
VECTOR2_8=-0.001122465582470511,0.0007297054642876333,-0.28087772713576203
VECTOR2_9=0.00037278116408145934,-0.26492341684219983,0.09297674033250446
VECTOR2_10=0.0014947856775577861,-0.2655712064500875,0.373739187028097
VECTOR2_11=0.2278158202417629,-0.1315295251422363,-0.3756872583192447
VECTOR2_12=0.22924012634032245,-0.3971416898465108,-0.0018901484946134417
VECTOR2_13=0.22931449803967718,0.39710324555933885,-5.7922796534271015e-05
VECTOR2_14=0.22968727920375756,0.1321798287171383,0.09291881753597019
VECTOR2_15=0.23073880413823603,0.13149108085506497,0.373739187028097
VECTOR2_16=0.45855485547911884,4.3071945781036904e-05,-0.0018901484946134417
 MORE_THAN={RATIONAL R_0=0.5 NN=15 MM=30}
 MEAN
... REFCV

diff2: MATHEVAL ARG=refcv3.mean,refcv.mean FUNC=((x-0.230)/(0.585-0.230)-(y-0.254)/(0.812-0.254)) PERIODIC=NO
UPPER_WALLS ARG=diff2 AT=0.05 KAPPA=100000 EXP=2 LABEL=uwall

Q6 SPECIES=1-288:3 SWITCH={CUBIC D_0=0.3 D_MAX=0.35} VMEAN LABEL=q6
diff3: MATHEVAL ARG=q6.vmean,refcv.mean FUNC=((x-0.0702)/(0.429-0.0702)-(y-0.254)/(0.812-0.254)) PERIODIC=NO
UPPER_WALLS ARG=diff3 AT=0.05 KAPPA=100000 EXP=2 LABEL=uwall2

PRINT STRIDE=500  ARG=* FILE=COLVAR
